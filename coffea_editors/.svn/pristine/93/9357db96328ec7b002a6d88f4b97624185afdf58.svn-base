package net.sourceforge.coffea.editors.figures;

import java.util.List;

import org.eclipse.draw2d.Label;
import org.eclipse.jdt.core.JavaModelException;
import org.eclipse.uml2.uml.VisibilityKind;

import net.sourceforge.coffea.editors.CoffeaEditorsPlugin;
import net.sourceforge.coffea.uml2.model.IMethodService;
import net.sourceforge.coffea.uml2.model.ITypeService;

/** Figure displaying a set of operations */
public class OperationsFigure extends MemberSetFigure<IMethodService> {
	
	/**
	 * Construction of a figure displaying a set of operations
	 * @param dsplMbrsSrvs
	 * List of services for all the displayed operations
	 */
	public OperationsFigure(List<IMethodService> dsplMbrsSrvs) {
		super(dsplMbrsSrvs);
		for(IMethodService operationSrv : displayedMembersServices) {
			operationSrv.setUpUMLModelElement();
			String visibility = new String();
			if(
					operationSrv.getUMLElement().getVisibility().equals(
							VisibilityKind.PRIVATE_LITERAL
					)
			) {
				visibility = "-";
			}
			else if(
					operationSrv.getUMLElement().getVisibility().equals(
							VisibilityKind.PROTECTED_LITERAL
					)
			) {
				visibility = "#";
			}
			else if(
					operationSrv.getUMLElement().getVisibility().equals(
							VisibilityKind.PUBLIC_LITERAL
					)
			) {
				visibility = "+";
			}
			String name = operationSrv.getSimpleName();
			ITypeService<?, ?> returnTypeSrv = 
				operationSrv.getReturnTypeHandler();
			String value = visibility + ' ' +name;
			if(returnTypeSrv != null) {
				value += " : " + returnTypeSrv.getSimpleName();
			}
			else {
				try {
					value += 
						" : " 
						+ operationSrv.getJavaElement().getReturnType();
				} catch (JavaModelException e) {
					CoffeaEditorsPlugin.getDefault().logError(
							e.getMessage(), 
							e
					);
				}
			}
			Label operationLabel = 
				new Label(value);
			add(operationLabel);
		}
	}

}
